# 胶片索引页生成器：核心共识与架构指南 (Core Consensus & Architecture Guide)

## 1. 项目愿景 (Project Vision)
* **核心目标**：复刻胶片时代的“诚实印记”。索引页 (Contact Sheet) 不只是缩略图，它是记录拍摄节奏、物理间隙与视觉逻辑的数字暗房实验。
* **开发者背景**：零基础摄影师主导审美，AI 提供工程支持。经历从 BAT 脚本到 Python + GitHub 的架构跨越。

## 2. 交互规范 (Interaction Protocol)
* **中英双语批注 (Bilingual Comments)**：【强制】所有新生成的代码或修改逻辑，必须附带中英双语注释。
* **审美驱动逻辑**：当数学上的“绝对对齐”与物理上的“视觉平衡”冲突时，优先模拟真实的底片物理感。

## 3. 架构设计共识 (System Architecture)
为了提高复用性，项目已完成核心功能解耦，形成了以 `core` 为中心的架构：

* **核心模块 (Core Library)**：
    * `metadata`：专门负责 EXIF 信息的抓取与解析。
    * `renderer`：基础渲染逻辑，定义如何绘制画格与画布。
    其他自行读取
* **解耦工具 (Independent Tools)**：
    * `Border Tool`：从主程序中独立出来的边框工具，专门处理边框样式、宽度及物理留白逻辑。
* **配置规范 (JSON Schemas)**：
    * `films.json`：定义不同胶片的物理属性（如底片型号喷码、品牌色彩倾向）。
    * `contact_layouts.json`：定义不同画幅（66, 645, 135, 67）的排版逻辑、物理格子步进及间距。
    * `layout.json`：定义不同画幅（66, 645, 135, 67）边框渲染逻辑。


## 4. 审美准则 (Aesthetic Standards)
* **物理格子逻辑 (Physical Grid)**：每一帧必须占据固定的“物理格子”，模拟底片在扫描仪/放大机下的真实状态。
* **绝对等宽黑边 (True-Uniform Margins)**：行间距 (Vertical Gap) 与页面底部留白 (Bottom Padding) 必须像素级一致。
* **喷码与画格解耦 (EdgeCode Decoupling)**：喷码遵循物理步进逻辑（如 645 逻辑），不与画面中心机械对齐，产生自然的“位移感”。
* **视觉细节**：
    * **字体**：拍摄参数使用 `Seven Segment` 字体（橙色）；边缘喷码借鉴柯达非衬线体风格。
    * **单位**：焦距单位 `mm` 强制小写。

## 5. 开发进度与路线图 (Roadmap)
* **已完成**：66 画幅的物理还原、环境向 Python 迁移、GitHub 版本控制。645画幅的适配。
* **进行中**：645画幅喷码等信息添加，135 画幅开发。核心难点是**齿孔 (Sprockets)** 的绘制逻辑，需模拟齿孔形状、频率及其与画格的相对位置。
* **计划中**：67 画幅适配。